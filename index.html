<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The New Invisible College</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --paper-bg: #faf8f2;
            --paper-border: #d4cfc3;
            --ink: #3a3a3a;
            --ink-soft: #615c54;
            --accent: #8c6b45; 
        }

        body {
            margin: 0; padding: 0;
            font-family: "Libre Baskerville", "Times New Roman", serif;
            background: var(--paper-bg); color: var(--ink);
            overflow: hidden; /* 防止页面滚动，交给SVG处理 */
        }

        header {
            text-align: center; padding: 1.5rem 0;
            border-bottom: 1px solid var(--paper-border);
            background: var(--paper-bg);
            z-index: 10; position: relative;
        }

        .container {
            display: flex; height: calc(100vh - 100px);
        }

        /* Sidebar */
        .sidebar {
            width: 350px; border-right: 1px solid var(--paper-border);
            background: #fdfbf6; padding: 20px;
            overflow-y: auto; z-index: 10;
        }

        .sidebar h2 { font-size: 1.3rem; color: var(--accent); margin-top: 0; }
        .relation-box { 
            margin-top: 20px; padding: 12px; 
            border-left: 3px solid var(--accent); 
            background: rgba(140, 107, 69, 0.05);
            font-size: 0.9rem;
        }

        /* Diagram Area */
        .diagram-container {
            flex: 1; position: relative; cursor: grab;
            background-color: #ffffff;
            user-select: none;
        }

        .diagram-container:active { cursor: grabbing; }

        svg { width: 100%; height: 100%; }

        .link { stroke: #d4cfc3; stroke-opacity: 0.5; stroke-width: 1.5; fill: none; transition: 0.3s; }
        .link.active { stroke: var(--accent); stroke-opacity: 1; stroke-width: 2.5; }

        .node circle { fill: white; stroke: var(--accent); stroke-width: 2; transition: 0.3s; }
        .node:hover circle { fill: #fff5e6; r: 15; }
        .node-text { font-size: 11px; fill: var(--ink); pointer-events: none; font-weight: bold; }
        
        .group-label { font-size: 14px; fill: var(--paper-border); font-style: italic; pointer-events: none; }
    </style>
</head>
<body>

<header>
    <div style="font-size: 1.8rem; font-weight: 600;">The New Invisible College</div>
    <div style="font-size: 0.8rem; letter-spacing: 2px; color: var(--ink-soft);">A GENEALOGY OF MODERN PHYSICS</div>
</header>

<div class="container">
    <aside class="sidebar" id="sidebar">
        <div id="intro">
            <h2>Notes</h2>
            <p style="font-size: 0.9rem; color: var(--ink-soft);">Click on a scientist to reveal their connections. Drag the background to pan, scroll to zoom.</p>
        </div>
        <div id="details" style="display:none;">
            <h2 id="s-name">Scientist</h2>
            <p id="s-bio" style="font-size: 0.95rem; line-height: 1.6;"></p>
            <hr style="border: 0; border-top: 1px solid var(--paper-border); margin: 20px 0;">
            <div id="s-links"></div>
        </div>
    </aside>

    <main class="diagram-container" id="canvas">
        <svg id="scene">
            <g id="main-group"></g>
        </svg>
    </main>
</div>

<script>
/* --- 1. DATA CONFIGURATION (按你的参考图分组) --- */
const groups = {
    "stat":    { x: 500, y: 50,  label: "Statistical Physics" },
    "atomic":  { x: 750, y: 150, label: "Atomic Model" },
    "rel":     { x: 250, y: 200, label: "Relativity & Atomic Theory" },
    "qm":      { x: 550, y: 350, label: "Quantum Mechanics" },
    "condensed":{ x: 950, y: 400, label: "Condensed Matter" },
    "nuclear": { x: 250, y: 500, label: "Nuclear Physics" },
    "astro":   { x: 800, y: 550, label: "Astrophysics" },
    "field":   { x: 550, y: 700, label: "Quantum Field Theory" }
};

const nodes = [
    // Statistical Physics (起源)
    { id: "boltzmann", label: "L. Boltzmann", group: "stat", bio: "统计力学之父。引入 $S = k \\ln W$，深刻影响了普朗克和薛定谔。" },
    { id: "maxwell", label: "J. C. Maxwell", group: "stat", bio: "建立电磁场理论与分子速率分布律。" },
    { id: "ehrenfest", label: "P. Ehrenfest", group: "stat", bio: "玻尔兹曼的学生，统计物理的传人，波尔的好友。" },
    { id: "gibbs", label: "J. W. Gibbs", group: "stat", bio: "奠定了化学热力学与统计力学的数学基础。" },

    // Atomic & Early Quantum
    { id: "thomson", label: "J.J. Thomson", group: "atomic", bio: "发现电子。提出了原子的“枣糕模型”。" },
    { id: "rutherford", label: "E. Rutherford", group: "atomic", bio: "核物理之父。通过散射实验发现原子核。" },
    { id: "bohr", label: "N. Bohr", group: "atomic", bio: "哥本哈根学派教父，提出量子化轨道原子模型。" },
    { id: "planck", label: "M. Planck", group: "qm", bio: "发现普朗克常数 $h$，开启量子时代。" },

    // Relativity & Roots
    { id: "michelson", label: "A. Michelson", group: "rel", bio: "迈克耳孙-莫雷实验证明了以太不存在。" },
    { id: "lorentz", label: "H. Lorentz", group: "rel", bio: "洛伦兹变换。爱因斯坦敬重的经典物理集大成者。" },
    { id: "einstein", label: "A. Einstein", group: "rel", bio: "相对论创立者。量子力学的最初推动者与终身质疑者。" },
    { id: "bose", label: "S. Bose", group: "rel", bio: "玻色-爱因斯坦统计。提出了光子的量子统计方法。" },
    { id: "perrin", label: "J. Perrin", group: "rel", bio: "通过布朗运动实验证实了原子的存在。" },

    // Quantum Mechanics (核心层)
    { id: "born", label: "M. Born", group: "qm", bio: "提出波函数的概率解释，量子力学数学框架的奠基人。" },
    { id: "heisenberg", label: "W. Heisenberg", group: "qm", bio: "矩阵力学与不确定性原理。波尔的得意门生。" },
    { id: "schrodinger", label: "E. Schrodinger", group: "qm", bio: "波动力学创立者。薛定谔方程 $\\hat{H}\\psi = E\\psi$。" },
    { id: "pauli", label: "W. Pauli", group: "qm", bio: "不相容原理。物理学的“良心”，极为毒舌且严谨。" },
    { id: "dirac", label: "P. Dirac", group: "qm", bio: "狄拉克方程。完美统一了量子力学与狭义相对论。" },

    // Condensed Matter & Soviet School
    { id: "ioffe", label: "A. Ioffe", group: "condensed", bio: "苏联物理学之父，半导体研究先驱。" },
    { id: "kapitsa", label: "P. Kapitsa", group: "condensed", bio: "发现液氦的超流性。" },
    { id: "landau", label: "L. Landau", group: "condensed", bio: "全才物理学家，凝聚态物理的领袖。" },

    // Nuclear & Astrophysics
    { id: "meitner", label: "L. Meitner", group: "nuclear", bio: "核裂变理论解释者。唯一没有获得诺奖的裂变发现者。" },
    { id: "oppenheimer", label: "J. Oppenheimer", group: "nuclear", bio: "曼哈顿计划领导者，量子力学在美国的传播者。" },
    { id: "teller", label: "E. Teller", group: "nuclear", bio: "氢弹之父。与奥本海默关系复杂。" },
    { id: "fermi", label: "E. Fermi", group: "nuclear", bio: "原子能之父。理论与实验兼长的全才。" },
    { id: "fowler", label: "R. Fowler", group: "astro", bio: "统计力学大师。狄拉克和钱德拉塞卡的导师。" },
    { id: "chandrasekhar", label: "S. Chandrasekhar", group: "astro", bio: "发现白矮星质量极限（钱德拉塞卡极限）。" },

    // High Energy & Particle (新生代)
    { id: "yukawa", label: "H. Yukawa", group: "field", bio: "预言介子，解释强相互作用。" },
    { id: "feynman", label: "R. Feynman", group: "field", bio: "路径积分，费曼图。量子电动力学大师。" },
    { id: "sakharov", label: "A. Sakharov", group: "field", bio: "苏联氢弹之父。重子失衡理论。" },
    { id: "wu", label: "C.S. Wu (吴健雄)", group: "field", bio: "物理学第一夫人。实验证实了宇称不守恒。" },
    { id: "lee", label: "T.D. Lee (李政道)", group: "field", bio: "提出弱相互作用下宇称不守恒。" },
    { id: "yang", label: "C.N. Yang (杨振宁)", group: "field", bio: "杨-米尔斯场论，杨-巴克斯特方程。当代最伟大的物理学家之一。" }
];

const links = [
    { from: "boltzmann", to: "planck", note: "普朗克借用了玻尔兹曼的统计方法才推导出黑体辐射公式。" },
    { from: "boltzmann", to: "schrodinger", note: "薛定谔曾说玻尔兹曼的思想是他的“第一场科学初恋”。" },
    { from: "thomson", to: "rutherford", note: "师徒关系。卢瑟福通过实验推翻了老师的枣糕模型。" },
    { from: "rutherford", to: "bohr", note: "波尔在卢瑟福实验室工作时受到了原子核发现的启发。" },
    { from: "einstein", to: "bose", note: "爱因斯坦亲自翻译并推荐了玻色的论文，促成BE统计。" },
    { from: "bohr", to: "heisenberg", note: "经典的师徒/父子关系。共同构建了哥本哈根诠释。" },
    { from: "heisenberg", to: "schrodinger", note: "一生之敌。矩阵力学与波动力学曾有过激烈的“话语权”争夺。" },
    { from: "born", to: "heisenberg", note: "玻恩用严谨的矩阵数学为海森堡的直觉提供了底座。" },
    { from: "fowler", to: "dirac", note: "福勒是狄拉克的导师，并将海森堡的初稿交给了狄拉克。" },
    { from: "fowler", to: "chandrasekhar", note: "导师关系。福勒将费米-狄拉克统计应用到了白矮星研究。" },
    { from: "fermi", to: "yang", note: "杨振宁在芝加哥大学追随费米。费米认为杨不仅数学好，直觉也极强。" },
    { from: "oppeneheimer", to: "yang", note: "杨振宁在普林斯顿高等研究院期间与奥本海默共事多年。" },
    { from: "yang", to: "lee", note: "曾经最完美的合作者。共同获得诺奖，后因署名问题绝交。" },
    { from: "wu", to: "lee", note: "李政道提议吴健雄进行钴-60实验，从而证实了宇称不守恒。" },
    { from: "kapitsa", to: "landau", note: "卡皮查二战期间通过私人信件从斯大林手中救出了被捕的朗道。" }
];

/* --- 2. LAYOUT ENGINE --- */
const mainGroup = document.getElementById('main-group');
const svg = document.getElementById('scene');

// 初始化布局坐标
nodes.forEach((node, i) => {
    const gCfg = groups[node.group];
    node.x = gCfg.x + (i % 3) * 100;
    node.y = gCfg.y + Math.floor(i / 3) * 100;
});

// 渲染连线 (增加了容错判断)
links.forEach(link => {
    const s = nodes.find(n => n.id === link.from);
    const t = nodes.find(n => n.id === link.to);
    
    // 如果 ID 拼错了，跳过这一条线，而不是让整个程序崩溃
    if (!s || !t) {
        console.warn(`Link Error: Could not find node ${!s ? link.from : link.to}`);
        return; 
    }

    const lEl = document.createElementNS("http://www.w3.org/2000/svg", "line");
    lEl.setAttribute("class", `link l-${link.from} l-${link.to}`);
    lEl.setAttribute("x1", s.x); lEl.setAttribute("y1", s.y);
    lEl.setAttribute("x2", t.x); lEl.setAttribute("y2", t.y);
    mainGroup.appendChild(lEl);
});
// 渲染节点
nodes.forEach(node => {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    g.setAttribute("class", "node");
    g.style.cursor = "pointer";

    const circ = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    circ.setAttribute("cx", node.x); circ.setAttribute("cy", node.y); circ.setAttribute("r", 10);
    
    const txt = document.createElementNS("http://www.w3.org/2000/svg", "text");
    txt.setAttribute("x", node.x); txt.setAttribute("y", node.y + 25);
    txt.setAttribute("text-anchor", "middle"); txt.setAttribute("class", "node-text");
    txt.textContent = node.label;

    g.appendChild(circ); g.appendChild(txt);
    g.onclick = (e) => { e.stopPropagation(); clickNode(node); };
    mainGroup.appendChild(g);
});

/* --- 3. INTERACTION & PAN/ZOOM --- */
let scale = 1, tx = 0, ty = 0;
let isDragging = false, startX, startY;

const updateTransform = () => {
    mainGroup.setAttribute("transform", `translate(${tx},${ty}) scale(${scale})`);
};

// Pan (拖动)
svg.onmousedown = (e) => {
    isDragging = true;
    startX = e.clientX - tx;
    startY = e.clientY - ty;
};

window.onmousemove = (e) => {
    if (!isDragging) return;
    tx = e.clientX - startX;
    ty = e.clientY - startY;
    updateTransform();
};

window.onmouseup = () => isDragging = false;

// Zoom (缩放)
svg.onwheel = (e) => {
    e.preventDefault();
    const delta = e.deltaY > 0 ? 0.9 : 1.1;
    scale *= delta;
    updateTransform();
};

function clickNode(node) {
    document.getElementById('intro').style.display = 'none';
    const det = document.getElementById('details');
    det.style.display = 'block';
    document.getElementById('s-name').textContent = node.label;
    document.getElementById('s-bio').innerHTML = node.bio;

    // Highlight links
    document.querySelectorAll('.link').forEach(l => l.classList.remove('active'));
    document.querySelectorAll(`.l-${node.id}`).forEach(l => l.classList.add('active'));

    // Populate Relations
    const rels = links.filter(l => l.from === node.id || l.to === node.id);
    document.getElementById('s-links').innerHTML = rels.map(r => {
        const other = r.from === node.id ? r.to : r.from;
        const otherNode = nodes.find(n => n.id === other);
        return `<div class="relation-box"><strong>vs ${otherNode.label}:</strong><br>${r.note}</div>`;
    }).join('');

    MathJax.typeset(); // Refresh Math symbols
}
</script>
</body>
</html>
